import { ref, computed } from "vue"

export type Lang = "en" | "zh"

const en = {
  loading: "Loading...",
  ttSearch: "Discover packages", ttRefresh: "Refresh", ttUpgradeAll: "Upgrade all",
  ttLogs: "Logs", ttSettings: "Settings",
  descInstalled: "All packages installed via Homebrew. Filter by type, search by name, install new packages, or uninstall existing ones.",
  descUpgradable: "Packages that have newer versions available. Upgrade individually or use the toolbar button to upgrade all at once.",
  descTaps: "Third-party Homebrew repositories that extend the available package catalog. Tap a GitHub repo to gain access to extra formulae and casks.",
  searchPlaceholder: "Search formula or cask…", searchHint: "Type a keyword to search…",
  installedTag: "Installed",
  panelInstalled: "Installed", filterAll: "All", filterPlaceholder: "Filter...",
  installPlaceholder: "Package name, e.g: wget, docker", btnInstall: "Install",
  ttInfo: "Info", ttUninstall: "Uninstall", noResults: "No results",
  panelUpgradable: "Updates", upToDate: "Up to date", ttUpgrade: "Upgrade this package",
  noTaps: "No third-party taps", ttRemoveTap: "Remove tap", btnAdd: "Add",
  logsTitle: "Logs", noLogs: "No logs",
  batchSelected: (n: number) => `${n} selected`,
  btnCancel: "Cancel", btnBatchUninstall: "Batch Uninstall", btnBatchUpgrade: "Batch Upgrade",
  btnConfirmOk: "Confirm",
  modalAddTap: "Add Tap", tapHint: "Enter GitHub user/repo (e.g: homebrew/cask-fonts)",
  running: "Running…", waitingOutput: "Waiting for output…",
  settingsTitle: "Brew Path Settings",
  settingsHint: "Custom brew executable path (leave empty for auto-detection)",
  settingsCurrentPath: "Current path", settingsNotDetected: "Not detected",
  settingsStdPaths: "Standard paths: /usr/local/bin/brew · /opt/homebrew/bin/brew · /home/linuxbrew/.linuxbrew/bin/brew",
  settingsLang: "Language", btnClear: "Clear", btnSave: "Save",
  settingsTabSettings: "Settings", settingsTabAbout: "About", settingsTabLicense: "License",
  aboutVersion: "Version", aboutDesc: "A native Homebrew package manager GUI for macOS and Linux.",
  aboutAuthor: "Author", aboutBuiltWith: "Built with Tauri · Vue 3 · TypeScript",
  aboutLicense: "Released under the MIT License",
  aboutOpenSource: "Open Source",
  // JS messages
  loadingRefresh: "Refreshing data...",
  logLoaded: (n: number) => `Loaded ${n} packages`,
  logLoadFailed: (msg: string) => `Load failed: ${msg}`,
  logUpdatable: (n: number) => `${n} updatable`,
  logRefreshFailed: (e: string) => `Refresh failed: ${e}`,
  loadingAddTap: (name: string) => `Adding tap: ${name}...`,
  titleAddTap: (name: string) => `Add Tap: ${name}`,
  notifyTapAdded: "Tap added",
  logTapAddFailed: (msg: string) => `Add tap failed: ${msg}`,
  logTapAddError: (e: string) => `Add tap error: ${e}`,
  logException: (e: string) => `\nException: ${e}`,
  confirmRemoveTapTitle: "Confirm Remove Tap",
  confirmRemoveTap: (name: string) => `Remove tap "${name}"?`,
  loadingRemoveTap: (name: string) => `Removing tap: ${name}...`,
  titleRemoveTap: (name: string) => `Remove Tap: ${name}`,
  notifyTapRemoved: "Tap removed",
  logTapRemoveFailed: (msg: string) => `Remove tap failed: ${msg}`,
  logTapRemoveError: (e: string) => `Remove tap error: ${e}`,
  confirmBatchUninstallTitle: "Batch Uninstall",
  confirmBatchUninstall: (n: number) => `Uninstall ${n} selected packages?\nWill execute one by one.`,
  loadingBatchUninstall: "Preparing batch uninstall...",
  titleBatchUninstall: (n: number) => `Batch Uninstall (${n})`,
  logBatchUninstalling: (i: number, total: number, name: string) => `\n[${i}/${total}] Uninstalling ${name}...\n`,
  logBatchUninstallOk: (name: string) => `✓ ${name} uninstalled\n`,
  logBatchUninstallFail: (name: string, msg: string) => `✗ ${name} failed: ${msg}\n`,
  logBatchDone: (ok: number, fail: number) => `\nBatch done. Success: ${ok}, Failed: ${fail}`,
  notifyBatchUninstallDone: "Batch uninstall complete",
  notifyBatchResult: (ok: number, total: number) => `${ok} / ${total} succeeded`,
  logInterrupted: (e: string) => `\nInterrupted: ${e}`,
  confirmBatchUpgradeTitle: "Batch Upgrade",
  confirmBatchUpgrade: (n: number) => `Upgrade ${n} selected packages?`,
  loadingBatchUpgrade: "Preparing batch upgrade...",
  titleBatchUpgrade: (n: number) => `Batch Upgrade (${n})`,
  logBatchUpgrading: (i: number, total: number, name: string) => `\n[${i}/${total}] Upgrading ${name}...\n`,
  logBatchUpgradeOk: (name: string) => `✓ ${name} upgraded\n`,
  logBatchUpgradeFail: (name: string, msg: string) => `✗ ${name} failed: ${msg}\n`,
  notifyBatchUpgradeDone: "Batch upgrade complete",
  logPleaseEnterName: "Please enter a package name",
  loadingInstall: (name: string) => `Installing ${name}...`,
  titleInstall: (name: string, kind: string) => `Install ${name} (${kind})`,
  logInstallOk: (name: string) => `Installed: ${name}`,
  logInstallFail: (msg: string) => `Install failed: ${msg}`,
  notifyInstallDone: "Install complete",
  logInstallError: (e: string) => `Install error: ${e}`,
  confirmUninstallTitle: "Confirm Uninstall",
  confirmUninstall: (name: string, kind: string) => `Uninstall "${name}" (${kind})?\nThis cannot be undone.`,
  loadingUninstall: (name: string) => `Uninstalling ${name}...`,
  titleUninstall: (name: string, kind: string) => `Uninstall ${name} (${kind})`,
  logUninstallOk: (name: string) => `Uninstalled: ${name}`,
  logUninstallFail: (msg: string) => `Uninstall failed: ${msg}`,
  notifyUninstallDone: "Uninstall complete",
  logUninstallError: (e: string) => `Uninstall error: ${e}`,
  confirmUpgradeAllTitle: "Confirm Upgrade All",
  confirmUpgradeAll: (n: number) => `Upgrade all ${n} available packages?`,
  loadingUpgradeAll: "Upgrading all packages...",
  titleUpgradeAll: "Upgrade All",
  logUpgradeAllDone: "All upgraded",
  logUpgradeAllFail: (msg: string) => `Upgrade failed: ${msg}`,
  notifyUpgradeAllDone: "Upgrade complete",
  notifyUpgradeAllBody: "All packages upgraded to latest",
  logUpgradeAllError: (e: string) => `Upgrade error: ${e}`,
  loadingUpgrade: (name: string) => `Upgrading ${name}...`,
  titleUpgrade: (name: string) => `Upgrade ${name}`,
  logUpgradeOk: (name: string) => `Upgraded: ${name}`,
  logUpgradeFail: (msg: string) => `Upgrade failed: ${msg}`,
  notifyUpgradeDone: "Upgrade complete",
  logUpgradeError: (e: string) => `Upgrade error: ${e}`,
  searchFailed: (e: string) => `Search failed: ${e}`,
  logSavedPath: (path: string) => `Saved path: ${path}`,
  logClearedPath: "Custom path cleared",
  loadingInfo: (name: string) => `Getting info for ${name}...`,
  infoFailed: (msg: string) => `Get info failed: ${msg}`,
  infoError: (e: string) => `Get info error: ${e}`,
  loadingDoctor: "Running brew doctor...",
  doctorDone: (msg: string) => `Doctor done: ${msg}`,
  doctorError: (e: string) => `Doctor error: ${e}`,
  cmdNoOutput: "Command finished, no output",
  cmdDone: "Command complete",
  cmdDoneWarning: "Command complete (with warnings)",
}

const zh: typeof en = {
  loading: "加载中...",
  ttSearch: "发现新包", ttRefresh: "刷新", ttUpgradeAll: "升级全部",
  ttLogs: "日志", ttSettings: "设置",
  descInstalled: "当前通过 Homebrew 安装的全部包。可按类型过滤、按名称搜索，支持安装新包与卸载已有包。",
  descUpgradable: "已有新版本可用的包。可单独升级，或点击工具栏按钮一次性升级全部。",
  descTaps: "扩展 Homebrew 软件目录的第三方仓库。通过 Tap GitHub 仓库来获取更多 formula 和 cask。",
  searchPlaceholder: "搜索 formula 或 cask…", searchHint: "输入关键词后等待搜索…",
  installedTag: "已安装",
  panelInstalled: "已安装", filterAll: "全部", filterPlaceholder: "过滤...",
  installPlaceholder: "输入包名安装，例如: wget、docker", btnInstall: "安装",
  ttInfo: "详情", ttUninstall: "卸载", noResults: "无匹配结果",
  panelUpgradable: "可升级", upToDate: "已是最新", ttUpgrade: "升级此包",
  noTaps: "暂无第三方 Tap", ttRemoveTap: "移除此 Tap", btnAdd: "添加",
  logsTitle: "操作日志", noLogs: "暂无日志",
  batchSelected: (n: number) => `已选择 ${n} 个包`,
  btnCancel: "取消", btnBatchUninstall: "批量卸载", btnBatchUpgrade: "批量升级",
  btnConfirmOk: "确认",
  modalAddTap: "添加 Tap", tapHint: "输入 GitHub 用户/仓库 (例如: homebrew/cask-fonts)",
  running: "执行中…", waitingOutput: "等待输出…",
  settingsTitle: "Brew 路径设置",
  settingsHint: "自定义 brew 可执行文件路径（留空则自动检测）",
  settingsCurrentPath: "当前路径", settingsNotDetected: "未检测到",
  settingsStdPaths: "标准路径：/usr/local/bin/brew · /opt/homebrew/bin/brew · /home/linuxbrew/.linuxbrew/bin/brew",
  settingsLang: "语言", btnClear: "清除", btnSave: "保存",
  settingsTabSettings: "设置", settingsTabAbout: "关于", settingsTabLicense: "许可证",
  aboutVersion: "版本", aboutDesc: "适用于 macOS 和 Linux 的原生 Homebrew 包管理器 GUI。",
  aboutAuthor: "作者", aboutBuiltWith: "基于 Tauri · Vue 3 · TypeScript 构建",
  aboutLicense: "以 MIT 许可证开源发布",
  aboutOpenSource: "开源项目",
  // JS messages
  loadingRefresh: "正在刷新数据...",
  logLoaded: (n: number) => `已加载 ${n} 个包`,
  logLoadFailed: (msg: string) => `加载包失败: ${msg}`,
  logUpdatable: (n: number) => `${n} 个可升级`,
  logRefreshFailed: (e: string) => `刷新失败: ${e}`,
  loadingAddTap: (name: string) => `正在添加 tap: ${name}...`,
  titleAddTap: (name: string) => `添加 Tap: ${name}`,
  notifyTapAdded: "Tap 添加成功",
  logTapAddFailed: (msg: string) => `添加 Tap 失败: ${msg}`,
  logTapAddError: (e: string) => `添加 Tap 异常: ${e}`,
  logException: (e: string) => `\n异常: ${e}`,
  confirmRemoveTapTitle: "确认移除 Tap",
  confirmRemoveTap: (name: string) => `确定要移除 tap "${name}" 吗？`,
  loadingRemoveTap: (name: string) => `正在移除 tap: ${name}...`,
  titleRemoveTap: (name: string) => `移除 Tap: ${name}`,
  notifyTapRemoved: "Tap 移除成功",
  logTapRemoveFailed: (msg: string) => `移除 Tap 失败: ${msg}`,
  logTapRemoveError: (e: string) => `移除 Tap 异常: ${e}`,
  confirmBatchUninstallTitle: "批量卸载",
  confirmBatchUninstall: (n: number) => `确定要卸载选中的 ${n} 个包吗？\n操作将逐个执行。`,
  loadingBatchUninstall: "准备批量卸载...",
  titleBatchUninstall: (n: number) => `批量卸载 (${n})`,
  logBatchUninstalling: (i: number, total: number, name: string) => `\n[${i}/${total}] 正在卸载 ${name}...\n`,
  logBatchUninstallOk: (name: string) => `✓ ${name} 卸载成功\n`,
  logBatchUninstallFail: (name: string, msg: string) => `✗ ${name} 卸载失败: ${msg}\n`,
  logBatchDone: (ok: number, fail: number) => `\n批量操作结束。成功: ${ok}, 失败: ${fail}`,
  notifyBatchUninstallDone: "批量卸载完成",
  notifyBatchResult: (ok: number, total: number) => `成功 ${ok} / ${total}`,
  logInterrupted: (e: string) => `\n异常中断: ${e}`,
  confirmBatchUpgradeTitle: "批量升级",
  confirmBatchUpgrade: (n: number) => `确定要升级选中的 ${n} 个包吗？`,
  loadingBatchUpgrade: "准备批量升级...",
  titleBatchUpgrade: (n: number) => `批量升级 (${n})`,
  logBatchUpgrading: (i: number, total: number, name: string) => `\n[${i}/${total}] 正在升级 ${name}...\n`,
  logBatchUpgradeOk: (name: string) => `✓ ${name} 升级成功\n`,
  logBatchUpgradeFail: (name: string, msg: string) => `✗ ${name} 升级失败: ${msg}\n`,
  notifyBatchUpgradeDone: "批量升级完成",
  logPleaseEnterName: "请输入包名",
  loadingInstall: (name: string) => `正在安装 ${name}...`,
  titleInstall: (name: string, kind: string) => `安装 ${name} (${kind})`,
  logInstallOk: (name: string) => `安装成功: ${name}`,
  logInstallFail: (msg: string) => `安装失败: ${msg}`,
  notifyInstallDone: "安装完成",
  logInstallError: (e: string) => `安装异常: ${e}`,
  confirmUninstallTitle: "确认卸载",
  confirmUninstall: (name: string, kind: string) => `确定要卸载 "${name}"（${kind}）吗？\n此操作无法撤销。`,
  loadingUninstall: (name: string) => `正在卸载 ${name}...`,
  titleUninstall: (name: string, kind: string) => `卸载 ${name} (${kind})`,
  logUninstallOk: (name: string) => `卸载成功: ${name}`,
  logUninstallFail: (msg: string) => `卸载失败: ${msg}`,
  notifyUninstallDone: "卸载完成",
  logUninstallError: (e: string) => `卸载异常: ${e}`,
  confirmUpgradeAllTitle: "确认升级",
  confirmUpgradeAll: (n: number) => `确定要升级所有 ${n} 个可用包吗？`,
  loadingUpgradeAll: "正在升级所有包...",
  titleUpgradeAll: "升级全部包",
  logUpgradeAllDone: "全部升级完成",
  logUpgradeAllFail: (msg: string) => `升级失败: ${msg}`,
  notifyUpgradeAllDone: "升级完成",
  notifyUpgradeAllBody: "所有包已升级到最新版本",
  logUpgradeAllError: (e: string) => `升级异常: ${e}`,
  loadingUpgrade: (name: string) => `正在升级 ${name}...`,
  titleUpgrade: (name: string) => `升级 ${name}`,
  logUpgradeOk: (name: string) => `升级成功: ${name}`,
  logUpgradeFail: (msg: string) => `升级失败: ${msg}`,
  notifyUpgradeDone: "升级完成",
  logUpgradeError: (e: string) => `升级异常: ${e}`,
  searchFailed: (e: string) => `搜索失败: ${e}`,
  logSavedPath: (path: string) => `已保存路径: ${path}`,
  logClearedPath: "已清除自定义路径",
  loadingInfo: (name: string) => `获取 ${name} 详情...`,
  infoFailed: (msg: string) => `获取详情失败: ${msg}`,
  infoError: (e: string) => `获取详情异常: ${e}`,
  loadingDoctor: "运行 brew doctor...",
  doctorDone: (msg: string) => `doctor 完成: ${msg}`,
  doctorError: (e: string) => `doctor 异常: ${e}`,
  cmdNoOutput: "命令执行结束，无输出",
  cmdDone: "命令完成",
  cmdDoneWarning: "命令完成（有告警）",
}

const i18n = { en, zh }

export const lang = ref<Lang>((localStorage.getItem("lang") as Lang) ?? "en")
export const t = computed(() => i18n[lang.value])
export function setLang(l: Lang) {
  lang.value = l
  localStorage.setItem("lang", l)
}
